// Til sozlamalari
const translations = {
    uz: {
        skills: "Ko'nikmalar",
        // Navigation
        home: "Bosh sahifa",
        about: "Men haqimda",
        services: "Xizmatlar",
        portfolio: "Portfolio",
        contact: "Aloqa",
        
        // Home section
        hello: "Salom, mening ismim <span class='name'>Obodov Shixnazar</span>",
        iam: "Men <span class='typing'>veb dasturchi</span>man",
        homeDesc: "Men zamonaviy veb texnologiyalari bo'yicha mutaxassis veb dasturchiman. Foydalanuvchilar uchun qulay va jozibali veb-saytlar yarataman.",
        hireMe: "Ishga yollang",
        
        // About section
        aboutTitle: "Men Obodov Shixnazar va <span>Veb Dasturchi</span>",
        aboutDesc: "Men 3 yildan ortiq tajribaga ega veb dasturchiman. Toza va samarali kod yozish, mijozlar kutganidan ham yaxshi natijalarni taqdim etish mening asosiy maqsadim.",
        birthday: "Tug'ilgan kun:",
        age: "Yosh:",
        website: "Veb sayt:",
        email: "Elektron pochta:",
        degree: "Daraja:",
        phone: "Telefon:",
        city: "Shahar:",
        freelance: "Freelance:",
        downloadCV: "CV Yuklab olish",
        
        // Education & Experience
        education: "Ta'lim",
        experience: "Ish tajribasi",
        bachelor: "Kompyuter fanlari bakalavri",
        bachelorDesc: "Toshkent Axborot Texnologiyalari Universitetini imtiyozli diplom bilan tamomladim. Veb dasturlash va dasturiy ta'minot muhandisligiga ixtisoslashganman.",
        frontend: "Frontend dasturlash kursi",
        frontendDesc: "React, Vue.js va zamonaviy JavaScript freymvorklariga qaratilgan ilg'or frontend dasturlash kursini tamomladim.",
        uiux: "UI/UX dizayn ixtisosligi",
        uiuxDesc: "Hozirda foydalanuvchi interfeysi va tajovuzini yaxshilash bo'yicha ko'nikmalarimni oshirmoqdamman.",
        junior: "Yosh veb dasturchi",
        juniorDesc: "TechSolutions kompaniyasida HTML, CSS, JavaScript va React yordamida moslashuvchan veb-saytlar va ilovalar ishlab chiqdim.",
        frontendDev: "Frontend dasturchi",
        frontendDevDesc: "DigitalCreations kompaniyasida Frontend dasturchi lavozimiga ko'tarildim, loyihalarni boshqardim va yosh dasturchilarga ustozlik qildim.",
        fullstack: "Full Stack dasturchi",
        fullstackDesc: "Hozirda InnovateTech kompaniyasida Full Stack dasturchi sifatida ishlayman, frontend va backend dasturlash bilan shug'ullanaman.",
        
        // Services
        webDev: "Veb dasturlash",
        webDevDesc: "React, Vue.js va Node.js kabi zamonaviy texnologiyalar yordamida maxsus veb-saytlar ishlab chiqish.",
        responsive: "Moslashuvchan dizayn",
        responsiveDesc: "Barcha qurilmalar va ekran o'lchamlarida mukammal ishlaydigan mobil-ilk, moslashuvchan dizaynlar yaratish.",
        uiuxDesign: "UI/UX dizayn",
        uiuxDesignDesc: "Foydalanuvchilarni jalb qiladigan va konversiyalarni oshiradigan intuitiv foydalanuvchi interfeyslari va tajovuzlarini loyihalash.",
        cleanCode: "Toza kod",
        cleanCodeDesc: "Eng yaxshi amaliyotlar va sanoat standartlariga rioya qilgan holda toza, qayta ishlanadigan va samarali kod yozish.",
        seo: "SEO optimallashtirish",
        seoDesc: "Qidiruv tizimlari uchun veb-saytlarni optimallashtirish, ko'rinishni oshirish va organik trafikni jalb qilish.",
        digital: "Raqamli marketing",
        digitalDesc: "Onlayn mavjudlikni oshirish va biznes o'sishini rag'batlantirish uchun raqamli marketing strategiyalarini amalga oshirish.",
        
        // Portfolio
        lastProjects: "Mening so'nggi loyihalarim:",
        ecommerce: "Elektron tijorat platformasi",
        travel: "Sayohat blogi",
        dashboard: "Biznes boshqaruv paneli",
        fitness: "Fitnes mobil ilovasi",
        artist: "Rassom portfoliasi",
        restaurant: "Restoran veb-sayti",
        
        // Contact
        anyQuestions: "Savollaringiz bormi?",
        atYourService: "Men sizning xizmatingizdam",
        callUs: "Qo'ng'iroq qiling",
        office: "Ofis",
        sendEmail: "MENGA ELEKTRON XAT YUBORING",
        responsiveMsg: "MEN XABARLARGA JUDAYAM TEZ JAVOB BERAMAN",
        sendMessage: "Xabar yuborish",
        namePlaceholder: "Ism",
        emailPlaceholder: "Elektron pochta",
        subjectPlaceholder: "Mavzu",
        messagePlaceholder: "Xabar",
        
        // Style switcher
        themeColors: "Mavzu ranglari",
        languages: "Tillar"
    },
    en: {
        skills: "Skills",
        // Navigation
        home: "Home",
        about: "About",
        services: "Services",
        portfolio: "Portfolio",
        contact: "Contact",
        
        // Home section
        hello: "Hello my name is <span class='name'>Obodov Shixnazar</span>",
        iam: "I am a <span class='typing'>web designer</span>",
        homeDesc: "I'm a passionate web developer with expertise in modern web technologies. I create responsive and user-friendly websites that deliver exceptional user experiences.",
        hireMe: "Hire Me",
        
        // About section
        aboutTitle: "I'm Obodov Shixnazar and <span>Web Developer</span>",
        aboutDesc: "I am a dedicated web developer with over 3 years of experience in creating dynamic and responsive websites. My passion lies in crafting clean, efficient code and delivering solutions that exceed client expectations.",
        birthday: "Birthday:",
        age: "Age:",
        website: "Website:",
        email: "Email:",
        degree: "Degree:",
        phone: "Phone:",
        city: "City:",
        freelance: "Freelance:",
        downloadCV: "Download CV",
        
        // Education & Experience
        education: "Education",
        experience: "Experience",
        bachelor: "Bachelor in Computer Science",
        bachelorDesc: "Graduated with honors from Tashkent University of Information Technologies. Specialized in web development and software engineering.",
        frontend: "Frontend Development Course",
        frontendDesc: "Completed advanced frontend development course focusing on React, Vue.js, and modern JavaScript frameworks.",
        uiux: "UI/UX Design Specialization",
        uiuxDesc: "Currently enhancing skills in user interface and user experience design to create more intuitive web applications.",
        junior: "Junior Web Developer",
        juniorDesc: "Worked at TechSolutions Inc. developing responsive websites and web applications using HTML, CSS, JavaScript and React.",
        frontendDev: "Frontend Developer",
        frontendDevDesc: "Advanced to Frontend Developer role at DigitalCreations, leading projects and mentoring junior developers.",
        fullstack: "Full Stack Developer",
        fullstackDesc: "Currently working as a Full Stack Developer at InnovateTech, handling both frontend and backend development.",
        
        // Services
        webDev: "Web Development",
        webDevDesc: "Custom website development using modern technologies like React, Vue.js, and Node.js for optimal performance.",
        responsive: "Responsive Design",
        responsiveDesc: "Creating mobile-first, responsive designs that work perfectly on all devices and screen sizes.",
        uiuxDesign: "UI/UX Design",
        uiuxDesignDesc: "Designing intuitive user interfaces and experiences that engage users and drive conversions.",
        cleanCode: "Clean Code",
        cleanCodeDesc: "Writing clean, maintainable, and efficient code following best practices and industry standards.",
        seo: "SEO Optimization",
        seoDesc: "Optimizing websites for search engines to improve visibility and drive organic traffic.",
        digital: "Digital Marketing",
        digitalDesc: "Implementing digital marketing strategies to increase online presence and business growth.",
        
        // Portfolio
        lastProjects: "My Last Projects:",
        ecommerce: "E-commerce Platform",
        travel: "Travel Blog",
        dashboard: "Business Dashboard",
        fitness: "Fitness Mobile App",
        artist: "Artist Portfolio",
        restaurant: "Restaurant Website",
        
        // Contact
        anyQuestions: "Have You Any Questions?",
        atYourService: "I Am At Your Services",
        callUs: "Call Us On",
        office: "Office",
        sendEmail: "SEND ME AN EMAIL",
        responsiveMsg: "I'M VERY RESPONSIVE TO MESSAGES",
        sendMessage: "Send Message",
        namePlaceholder: "Name",
        emailPlaceholder: "Email",
        subjectPlaceholder: "Subject",
        messagePlaceholder: "Message",
        
        // Style switcher
        themeColors: "Theme Colors",
        languages: "Languages"
    },
    ru: {
        skills: "Навыки",
        // Navigation
        home: "Главная",
        about: "Обо мне",
        services: "Услуги",
        portfolio: "Портфолио",
        contact: "Контакты",
        
        // Home section
        hello: "Привет, меня зовут <span class='name'>Ободов Шихназар</span>",
        iam: "Я <span class='typing'>веб-разработчик</span>",
        homeDesc: "Я увлеченный веб-разработчик с опытом работы в современных веб-технологиях. Создаю адаптивные и удобные веб-сайты, которые обеспечивают исключительный пользовательский опыт.",
        hireMe: "Нанять меня",
        
        // About section
        aboutTitle: "Я Ободов Шихназар и <span>Веб-Разработчик</span>",
        aboutDesc: "Я dedicated веб-разработчик с более чем 3-летним опытом создания динамичных и адаптивных веб-сайтов. Моя страсть - создавать чистый, эффективный код и предоставлять решения, превосходящие ожидания клиентов.",
        birthday: "День рождения:",
        age: "Возраст:",
        website: "Веб-сайт:",
        email: "Эл. почта:",
        degree: "Образование:",
        phone: "Телефон:",
        city: "Город:",
        freelance: "Фриланс:",
        downloadCV: "Скачать резюме",
        
        // Education & Experience
        education: "Образование",
        experience: "Опыт работы",
        bachelor: "Бакалавр компьютерных наук",
        bachelorDesc: "Окончил с отличием Ташкентский университет информационных технологий. Специализировался на веб-разработке и программной инженерии.",
        frontend: "Курс фронтенд-разработки",
        frontendDesc: "Прошел продвинутый курс фронтенд-разработки с фокусом на React, Vue.js и современных фреймворках JavaScript.",
        uiux: "Специализация UI/UX дизайн",
        uiuxDesc: "В настоящее время совершенствую навыки в области проектирования пользовательского интерфейса и опыта для создания более интуитивных веб-приложений.",
        junior: "Младший веб-разработчик",
        juniorDesc: "Работал в TechSolutions Inc., разрабатывая адаптивные веб-сайты и приложения с использованием HTML, CSS, JavaScript и React.",
        frontendDev: "Фронтенд-разработчик",
        frontendDevDesc: "Повышен до должности фронтенд-разработчика в DigitalCreations, руководил проектами и наставлял младших разработчиков.",
        fullstack: "Full Stack разработчик",
        fullstackDesc: "В настоящее время работаю Full Stack разработчиком в InnovateTech, занимаюсь как фронтенд, так и бэкенд разработкой.",
        
        // Services
        webDev: "Веб-разработка",
        webDevDesc: "Разработка пользовательских веб-сайтов с использованием современных технологий, таких как React, Vue.js и Node.js для оптимальной производительности.",
        responsive: "Адаптивный дизайн",
        responsiveDesc: "Создание мобильных, адаптивных дизайнов, которые идеально работают на всех устройствах и размерах экранов.",
        uiuxDesign: "UI/UX дизайн",
        uiuxDesignDesc: "Проектирование интуитивных пользовательских интерфейсов и опыта, которые привлекают пользователей и повышают конверсию.",
        cleanCode: "Чистый код",
        cleanCodeDesc: "Написание чистого, поддерживаемого и эффективного кода в соответствии с лучшими практиками и отраслевыми стандартами.",
        seo: "SEO оптимизация",
        seoDesc: "Оптимизация веб-сайтов для поисковых систем для улучшения видимости и привлечения органического трафика.",
        digital: "Цифровой маркетинг",
        digitalDesc: "Реализация стратегий цифрового маркетинга для увеличения онлайн-присутствия и роста бизнеса.",
        
        // Portfolio
        lastProjects: "Мои последние проекты:",
        ecommerce: "E-commerce платформа",
        travel: "Тревел блог",
        dashboard: "Бизнес панель",
        fitness: "Фитнес мобильное приложение",
        artist: "Портфолио художника",
        restaurant: "Сайт ресторана",
        
        // Contact
        anyQuestions: "Есть вопросы?",
        atYourService: "Я к вашим услугам",
        callUs: "Позвоните нам",
        office: "Офис",
        sendEmail: "ОТПРАВЬТЕ МНЕ EMAIL",
        responsiveMsg: "Я ОЧЕНЬ ОТЗЫВЧИВ К СООБЩЕНИЯМ",
        sendMessage: "Отправить сообщение",
        namePlaceholder: "Имя",
        emailPlaceholder: "Эл. почта",
        subjectPlaceholder: "Тема",
        messagePlaceholder: "Сообщение",
        
        // Style switcher
        themeColors: "Цвета темы",
        languages: "Языки"
    }
};

// Bayroq SVG ma'lumotlari
const flags = {
    uz: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAT4AAACfCAMAAABX0UX9AAAAdVBMVEX///8etToAmbXOESbKAAD++PocjKfXABLWACUxpTgbtzoAl7QAmLUAkrAAlLEAkbC/4OiPyNbq9vjz+vvf8PSAwtIAjKw9p7+bzttwu80UnrjI5Ou12+TQ6O6t1+FZssdouMsupLxDrMJas8eg1N9uvc+Jw9MHqo32AAAE1klEQVR4nO2cC5eiOBBGa9nnTJGEpyLKU6f//09cFJXQ2yKeorc1/d0zZ87JAGm5BqpSyTR5QAB99Qd4baBPBPSJgD4Rs/Uxa620Xuan+st08/XM08dKt+mh3AZhM6/b9bjZ8qjZ5K74m6OPVR3ERBRn63m37atC+XZz2/DQ9nUaakf8zdBnNlHnjqJazXx0c6+ltvv72mQKtXVUbQs1HH5p7urTTXGUR6Hie6dershOF2Tn87k+jlzaXg43yenLWN+6/KW4p09tTi7itZrfp153VzTXC9jvhKVm6HJHFMz+Mp6bO/pUP5IS75G75YYSsmKMoYjehqdXBRRvH/g2nplpfWd70WP5is42q7S8XsN1adZbq4ui++NI7J3Up89P7kNjryNnT1uhIdejDrqjo8OvzKS+5mSP9gslyw4ypc/0MTcwE+d8cyb08b4ffP/fh3k9JuSYU4JGpSNB8lO4rY/bfvDNnOV+T27r07s+5cObb4Lb+kzcT9aWCLtuJHkfcFvfOWtp5+V8+VTTnzz6ytzUx/U57s4bOeVokKrdKN7octQL1xs3ZrwT+vT8+ZqvTRqthiKANjnlZpi0qVWUmqHCp1a77cqRcH5bX9nru3+ffh4UMRXJr0uF6pAklCSHS/NXUlCcBJdZ7rrosvGiaKWf/ClYQF9nKOgmxtV1uKnwVB+89lR1QSi4jk3Ou3wyadx4fBfRp7v3ZLKyeyWyHvpVRFRbBauu553zD2/YV1vm5C2qCHOrfKyzgIMh4eE2ykOrwMdRVc3q9gVYJvKuNXM1NFvlqdZqMuuh6Tc5c964kQrezvvyh/K+BziK892wN6FPRcvNOpxlYs7bx47EkZf85zCj4uJGivE5TNT7VF/vcyXH+BSmqs1VP/zcmeAvz+Rax/akb4uK300mVzLOucvmg+DL7zKPdy9IPdl8dOHzeZnUd3l8/xs9eF+N/22c3+h3zWx0Mle1K/7u7DJIP1wnZ2122VCR8rWqE6OHooBm8uzmKrF3Z2mTlcaRbPLeHpfzPoPcvl2uDmEcheV5luvnWVhQmF1qoBxmJZVZeDl7k4VUhIdLBGqzMI7DQ7vcPXwhd3dYVf2SR2Xvd9Tp6JXI7fGcod6cH5fXi2vAPuXf8XXy11+cujH87i6Cs9fH35KtHaHm0M3mhoCsu3dkYRWsTHe+1Vx1OodqoGdCosyRZHLO7tLqtFkjDvlaj1dxVlqVQB0UGys95DSuY2s5I6dNEVj1vuiQxd9Hn8cqz04zkO3m7KipldoMNSdOjV7vh1iRsvbSoblvtBma/vHi2pHF95k7WLTK27esPLydb5vHmR97o1xuuumzO4nf/A1ArDtcue2lwP4pEdAnAvpEQJ8I+gsIoL+BAPodCKA/gAD6EwggAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHhSvvr/Y782+F0GIvCbNETQP0AA/QAC6CcQQL8BAdAnAvpEQJ8I6BMBfSKgTwT0iYA+EdAnAvpEQJ8I6BMBfSKgTwT0iYA+EdAnAvpEQJ8I6BMBfSKgTwT0iYA+EdAnAvpEQJ8I6BMBfSKgTwT0iYA+EdAnAvpEQJ8I6BMBfSKgTwT0iYA+EdAnAvpEQJ8I6BMBfSKgTwT0iYA+Ef8CLAI1Nd9GNq4AAAAASUVORK5CYII=",
    en: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQwIiBoZWlnaHQ9IjQ4MCIgdmlld0JveD0iMCAwIDY0MCA0ODAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI2NDAiIGhlaWdodD0iNDgwIiBmaWxsPSIjMDEyMTY5Ii8+CjxwYXRoIGQ9Ik0yNjEuMyAyNDBIMzg3LjdMMzI0LjUgMzYzLjhWMjQwWiIgZmlsbD0id2hpdGUiIHRyYW5zZm9ybT0icm90YXRlKDkwIDI2MS4zIDI0MCkiLz4KPHBhdGggZD0iTTI2MS4zIDI0MEgzODcuN0wzMjQuNSAxMTYuMlYyNDBaIiBmaWxsPSJ3aGl0ZSIgdHJhbnNmb3JtPSJyb3RhdGUoOTAgMzg3LjcgMjQwKSIvPgo8cGF0aCBkPSJNMzI0LjUgMjQwVjExNi4yTDI2MS4zIDI0MEgzMjQuNVoiIGZpbGw9IndoaXRlIiB0cmFuc2Zvcm09InJvdGF0ZSg5MCAzMjQuNSAxMTYuMikiLz4KPHBhdGggZD0iTTMyNC41IDI0MFYzNjMuOEwzODcuNyAyNDBIMzI0LjVaIiBmaWxsPSJ3aGl0ZSIgdHJhbnNmb3JtPSJyb3RhdGUoOTAgMzI0LjUgMzYzLjgpIi8+CjxyZWN0IHg9IjI0MCIgd2lkdGg9IjE2MCIgaGVpZ2h0PSI0ODAiIGZpbGw9IndoaXRlIi8+CjxyZWN0IHk9IjI0MCIgd2lkdGg9IjY0MCIgaGVpZ2h0PSIxNjAiIGZpbGw9IndoaXRlIi8+CjxyZWN0IHg9IjI3My4zIiB3aWR0aD0iOTMuNCIgaGVpZ2h0PSI0ODAiIGZpbGw9IiNjYTAwMTYiLz4KPHJlY3QgeT0iMjczLjMiIHdpZHRoPSI2NDAiIGhlaWdodD0iOTMuNCIgZmlsbD0iI2NhMDAxNiIvPgo8L3N2Zz4K",
    ru: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQwIiBoZWlnaHQ9IjQ4MCIgdmlld0JveD0iMCAwIDY0MCA0ODAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI2NDAiIGhlaWdodD0iMTYwIiBmaWxsPSJ3aGl0ZSIvPgo8cmVjdCB5PSIxNjAiIHdpZHRoPSI2NDAiIGhlaWdodD0iMTYwIiBmaWxsPSIjZDAwIi8+CjxyZWN0IHk9IjMyMCIgd2lkdGg9IjY0MCIgaGVpZ2h0PSIxNjAiIGZpbGw9IiMwMDM1YTgiLz4KPC9zdmc+Cg=="
};

// Typing animation strings for different languages
const typingStrings = {
    uz: ["Veb Dizayner", "Veb Dasturchi", "UI/UX Dizayner", "Grafik Dizayner"],
    en: ["Web Designer", "Web Developer", "UI/UX Designer", "Graphic Designer"],
    ru: ["Веб-Дизайнер", "Веб-Разработчик", "UI/UX Дизайнер", "Графический Дизайнер"]
};

// DOM loaded event
document.addEventListener('DOMContentLoaded', function() {
    console.log("🚀 DOM loaded - initializing all functions");
    // Initialize all functionality after DOM is fully loaded
    initPortfolio();
    initTypingAnimation();
    initNavToggler();
    initStyleSwitcher();
    initActiveMenu();
    initSmoothScrolling();
    initLanguageSwitcher();
});

// Typing animation - YANGILANGAN VERSIYA
function initTypingAnimation() {
    const typingElement = document.querySelector(".typing");
    if (typingElement) {
        console.log("⌨️ Typing animation initializing...");
        
        // Avvalgi typed instance ni tozalash
        if (window.typed) {
            window.typed.destroy();
        }
        
        // Current tilni olish
        const currentLang = localStorage.getItem('language') || 'uz';
        const strings = typingStrings[currentLang] || typingStrings['uz'];
        
        // Yangi typed instance yaratish
        setTimeout(() => {
            window.typed = new Typed(".typing",{ 
                strings: strings,
                typeSpeed: 100, 
                backSpeed: 60, 
                loop: true,
                startDelay: 500
            });
            console.log("✅ Typing animation started with strings:", strings);
        }, 100);
    } else {
        console.log("❌ Typing element not found");
    }
}

// Til o'zgartirish funksiyasi
function initLanguageSwitcher() {
    console.log("🌐 Language switcher initializing...");
    
    // Saqlangan tilni yuklash
    const savedLanguage = localStorage.getItem('language') || 'uz';
    changeLanguage(savedLanguage);
}

// Tilni o'zgartirish funksiyasi - YANGILANGAN VERSIYA
function changeLanguage(lang) {
    console.log("🔄 Changing language to:", lang);
    
    if (!translations[lang]) {
        console.error("❌ Language not found:", lang);
        return;
    }
    
    const translation = translations[lang];
    
    // Typing animation ni to'xtatish
    if (window.typed) {
        window.typed.destroy();
    }
    
    // Barcha tarjima qilinadigan elementlarni yangilash
    document.querySelectorAll('.translatable').forEach(element => {
        const key = element.getAttribute('data-key');
        if (translation[key]) {
            if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                element.placeholder = translation[key];
            } else {
                element.innerHTML = translation[key];
            }
        }
    });
    
    // HTML lang atributini yangilash
    document.documentElement.lang = lang;
    
    // Bayroqni yangilash
    const currentFlag = document.getElementById('current-flag');
    if (currentFlag && flags[lang]) {
        currentFlag.src = flags[lang];
        currentFlag.alt = lang + " flag";
    }
    
    // Active tilni yangilash
    updateActiveLanguage(lang);
    
    // Tilni saqlash
    localStorage.setItem('language', lang);
    
    // Typing animation ni qayta boshlash
    setTimeout(() => {
        initTypingAnimation();
    }, 100);
    
    console.log("✅ Language changed to:", lang);
}

// Active tilni yangilash
function updateActiveLanguage(activeLang) {
    const langOptions = document.querySelectorAll('.lang-option');
    langOptions.forEach(option => {
        option.classList.remove('active');
        if (option.getAttribute('onclick').includes(activeLang)) {
            option.classList.add('active');
        }
    });
}

// Nav toggler
function initNavToggler() {
    const navToggler = document.querySelector(".nav-toggler");
    if (navToggler) {
        navToggler.addEventListener("click", () => {
            document.querySelector(".aside").classList.toggle("open");
            document.querySelector(".nav-toggler").classList.toggle("open");
            document.body.classList.toggle("aside-open");
        });
    }
}

// Active menu
function initActiveMenu() {
    const nav = document.querySelectorAll(".nav li a");
    const sections = document.querySelectorAll(".section");

    function activeMenu() {
        let len = sections.length;
        while(--len && window.scrollY + 97 < sections[len].offsetTop){}
        nav.forEach(ltx => ltx.classList.remove("active"));
        if (nav[len]) {
            nav[len].classList.add("active");
        }
    }

    activeMenu();
    window.addEventListener("scroll", activeMenu);
    
    // Close mobile menu when clicking on nav links
    nav.forEach(link => {
        link.addEventListener('click', function() {
            if (window.innerWidth <= 1199) {
                document.querySelector(".aside").classList.remove("open");
                document.querySelector(".nav-toggler").classList.remove("open");
            }
        });
    });
}

// Style Switcher
function initStyleSwitcher() {
    console.log("🎨 Style switcher initializing...");
    
    // Style Switcher Toggle
    const styleSwitcherToggle = document.querySelector(".style-switcher-toggler");
    if (styleSwitcherToggle) {
        styleSwitcherToggle.addEventListener("click", () => {
            const switcher = document.querySelector(".style-switcher");
            if (switcher) {
                switcher.classList.toggle("open");
                console.log("📱 Style switcher toggled");
            }
        });
    }

    // Hide style switcher on scroll
    window.addEventListener("scroll",() => {
        const switcher = document.querySelector(".style-switcher");
        if(switcher && switcher.classList.contains("open")){
            switcher.classList.remove("open");
        }
    });

    // Global setActiveStyle funksiyasi
    window.setActiveStyle = function(color) {
        console.log("🎯 Setting active style:", color);
        
        const alternateStyles = document.querySelectorAll(".alternate-style");
        
        // Barcha style fayllarini disable qilish
        alternateStyles.forEach((style) => {
            if (color === style.getAttribute("title")) {
                console.log("✅ Enabling:", style.getAttribute("title"));
                style.removeAttribute("disabled");
                // Saqlash
                localStorage.setItem('theme-color', color);
            } else {
                console.log("❌ Disabling:", style.getAttribute("title"));
                style.setAttribute("disabled", "true");
            }
        });
        
        // Active rangni yangilash
        updateActiveColorIndicator(color);
        
        // Tez orada rang o'zgarishini tekshirish
        setTimeout(() => {
            const computedStyle = getComputedStyle(document.documentElement);
            const skinColor = computedStyle.getPropertyValue('--skin-color').trim();
            console.log("🎨 Current --skin-color value:", skinColor);
        }, 100);
    }

    // Active rang indikatorini yangilash
    function updateActiveColorIndicator(activeColor) {
        const colorSpans = document.querySelectorAll('.colors span');
        colorSpans.forEach(span => {
            span.classList.remove('active');
            if (span.classList.contains(activeColor)) {
                span.classList.add('active');
                console.log("🔵 Active color indicator:", activeColor);
            }
        });
    }

    // Saqlangan rangni yuklash
    function loadSavedTheme() {
        const savedColor = localStorage.getItem('theme-color');
        if (savedColor) {
            console.log("💾 Loading saved color:", savedColor);
            setActiveStyle(savedColor);
        } else {
            // Default rang
            console.log("⚡ Setting default color: color-1");
            setActiveStyle('color-1');
        }
    }

    // Dark/Light Mode
    const dayNight = document.querySelector(".day-night");
    if (dayNight) {
        console.log("🌙 Day/Night mode initializing...");
        
        // Saqlangan temani yuklash
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
            document.body.classList.add('dark');
            console.log("🌑 Dark theme loaded from storage");
        }

        // Iconni current tema bo'yicha sozlash
        const isDark = document.body.classList.contains('dark');
        const icon = dayNight.querySelector("i");
        
        if (isDark) {
            icon.classList.add("fa-sun");
            icon.classList.remove("fa-moon");
            console.log("☀️ Dark mode icon set to sun");
        } else {
            icon.classList.add("fa-moon");
            icon.classList.remove("fa-sun");
            console.log("🌙 Light mode icon set to moon");
        }

        dayNight.addEventListener("click", () => {
            const icon = dayNight.querySelector("i");
            icon.classList.toggle("fa-sun");
            icon.classList.toggle("fa-moon");
            document.body.classList.toggle("dark");
            
            // Saqlash
            const currentTheme = document.body.classList.contains('dark') ? 'dark' : 'light';
            localStorage.setItem('theme', currentTheme);
            console.log("🔄 Theme toggled to:", currentTheme);
        });
    }

    // Dastlabki yuklash
    loadSavedTheme();
}

// Portfolio initialization
function initPortfolio() {
    console.log('💼 Portfolio initialized');
}

// Smooth scrolling for anchor links
function initSmoothScrolling() {
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });
}

// Preload images to prevent layout shift
function preloadImages() {
    const images = document.querySelectorAll('img');
    images.forEach(img => {
        if (!img.complete) {
            img.addEventListener('load', function() {
                this.style.opacity = '1';
            });
            img.style.opacity = '0';
            img.style.transition = 'opacity 0.3s ease';
        }
    });
}

// Initialize when window loads
window.addEventListener('load', function() {
    preloadImages();
    
    // Ensure home image is visible
    const homeImg = document.querySelector('.home-img');
    if (homeImg) {
        homeImg.style.display = 'flex';
    }
});

// Contact form yuborish
function initContactForm() {
    const contactForm = document.querySelector('.contact-form');
    if (contactForm) {
        contactForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const data = {
                name: this.querySelector('input[placeholder*="Name"], input[placeholder*="Ism"], input[placeholder*="Имя"]').value,
                email: this.querySelector('input[placeholder*="Email"]').value,
                subject: this.querySelector('input[placeholder*="Subject"], input[placeholder*="Mavzu"], input[placeholder*="Тема"]').value,
                message: this.querySelector('textarea').value
            };
            
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            
            // Loading holati
            submitBtn.textContent = 'Yuborilmoqda...';
            submitBtn.disabled = true;
            
            try {
                const response = await fetch('contact.php', { // yoki '/contact' Node.js uchun
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alert(result.message);
                    this.reset();
                } else {
                    alert(result.message);
                }
                
            } catch (error) {
                console.error('Xatolik:', error);
                alert('Xabar yuborishda xatolik yuz berdi');
            } finally {
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        });
    }
}

// DOM loaded eventga qo'shing
document.addEventListener('DOMContentLoaded', function() {
    // ... existing code ...
    initContactForm();
});